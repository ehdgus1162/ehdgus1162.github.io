---
title: float에 메모리가 담기는 원리
date: 2025-04-15 17:05:49 +0900
categories: [Java]
tags: [Java, basic, floating-point, IEEE-754, data-type]
toc: true
permalink: /posts/java/:title/
---

# 부동소수점의 개념과 계산

자바는 IEEE 754 표준에 근거해 float 타입과 double 타입의 값을 부동 소수점(floating-point) 방식으로 메모리에 저장합니다.

## 부동소수점이란?

부동소수점(Floating-point)이란 소수점 위치가 숫자마다 바뀜(필요에 따라 조정됨)을 의미합니다. 이 방식은 매우 큰 수부터 매우 작은 수까지 다양한 크기의 실수를 효율적으로 표현할 수 있습니다.

## 부동소수점의 구성 요소

| 구성 요소 | 의미 |
|----------|------|
| 부호 비트 | 양수/음수 (0: 양수, 1: 음수) |
| 지수 (exponent) | 소수점 위치를 조정하는 값 (몇 승인지?) |
| 가수 (mantissa) | 실제 숫자의 유효 숫자 |

## 자바에서 부동소수점 저장 방식

float 타입과 double 타입은 가수와 지수를 저장하기 위해 전체 bit를 다음과 같이 나누어 사용합니다.

| 타입 | 저장 방식 | 비트 수 |
|------|-----------|---------|
| float | 부호 1 + 지수 8 + 가수 23 | 32비트 |
| double | 부호 1 + 지수 11 + 가수 52 | 64비트 |

## 예시로 보는 float의 메모리 구조

`6.5`(10진수)를 float에 저장해보겠습니다.

### IEEE 754 기반 32비트 float 저장 구조

| 부호 (1비트) | 지수 (8비트)   | 가수 (23비트)                     |
|--------------|----------------|----------------------------------|
| 0            | 10000001       | 10100000000000000000000          |

### 부동 소수점 계산 방식
```
실수 = (-1)^부호 × 1.가수 × 2^(지수 - 127)
```

### 단계별 계산

1. **부호 비트**
   - 양수이므로 `부호 = 0`

2. **6.5의 2진수 변환**
   - 정수 부분: `6 → 110`
   - 소수 부분: `0.5 → .1`
   - 결과: `6.5 = 110.1` (2진수)

3. **이진 과학적 표기법(binary scientific notation)**
   - `110.1 = 1.101 × 2^2` → 소수점 오른쪽으로 2칸 이동
   - 지수: `2`
   - 가수: `1.101` → 앞의 1(hidden bit)은 생략하고 `101...`만 저장

| 비트 | 위치 | 값 (2의 n승) | 계산 | 결과 |
|------|------|--------------|------|------|
| 1 | 2⁰ | 1 | 1 × 1 |  +1 |
| .1 | 2⁻¹ | 0.5 | 1 × 0.5 |  +0.5 |
| .0 | 2⁻² | 0.25 | 0 × 0.25 | 0은 더하지 않음 |
| .1 | 2⁻³ | 0.125 | 1 × 0.125 |  +0.125 |

```
실제지수 = 129 - 127 = 2
실수값 = (-1)^0 × 1.101 × 2^2 = 1.625 × 4 = 6.5
```

4. **지수 변환 (Bias 적용)**
   - Bias = 127 (음수 지수를 처리하기 위한 조정값)
   - 실제 저장값 = `2 + 127 = 129`
   - 129 = `10000001` (2진수)

5. **가수 저장**
   - `1.101` → `10100000000000000000000` (23비트 채움)
   - hidden bit는 저장하지 않고 101 뒤에 나머지 비트를 채움

### 최종 메모리 구성 (float)
```
[ 부호 ] [   지수    ] [           가수           ]
   0     10000001      10100000000000000000000
```

### 16진수 표현
```
→ 0x40D00000
```

> 위 구조는 float에서 6.5가 어떻게 저장되는지를 비트 단위로 보여주는 정확한 표현입니다.

## 부동소수점의 한계

10진수 실수 중 일부는 2진수로 정확히 표현할 수 없어 근사치로 저장됩니다. 예를 들어:

```
0.1 (10진수) ≈ 0.0001100110011... (2진수, 무한 반복)
```

이로 인해 정밀한 계산에서 오차가 발생할 수 있습니다:

```
실제 0.1:        0.1 (10진수)
float 저장값:     0.10000000149011612
double 저장값:    0.10000000000000000555...
```

> 금융 계산 등 정밀도가 중요한 경우에는 `BigDecimal` 클래스를 사용하는 것이 좋습니다.